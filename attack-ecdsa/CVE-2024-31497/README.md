# CVE-2024-31497: PuTTY ECDSA P-521 Nonce Bias (Sim + Exploit)

Minimal demo of PuTTY's biased nonce on P-521 and an LLL-based key recovery script.

## Files
- `server.py`: TCP service on `1337` that signs with the biased nonce (top 9 bits zeroed due to SHA-512 on a 521-bit curve). Offers menu to fetch pubkey or random message + signature.
- `attack.py`: Collects signatures, builds the lattice (bias = 2^512), runs `LLL()`, tests candidates via `d = r⁻¹ (k·s - m) mod q`, and prints the recovered private key.
- `build_and_run.sh`: Build Docker image `cve-2024-31497` and run container exposing `1337`.
- `dockerfile`: Python 3.9 slim image, installs `ecdsa`, runs `server.py` as unprivileged `ctf` user; includes `socat`.

## Requirements
- Docker (for containerized run), or Python 3.9+ with `ecdsa`, `pycryptodome`, `sage` (for `attack.py`).

## Run the vulnerable service
```bash
cd attack-ecdsa/CVE-2024-31497
./build_and_run.sh
# connect: nc localhost 1337
# stop:    docker stop cve-2024-31497-simulation
```

## Run the exploit demo
```bash
cd attack-ecdsa/CVE-2024-31497
python3 attack.py
```

## References

1. https://github.com/elikaski/ECC_Attacks?tab=readme-ov-file#generating-k-values-insecurely

2. https://github.com/HugoBond/CVE-2024-31497-POC/blob/main/README.md

